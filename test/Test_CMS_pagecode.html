<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>Test CMS page coding</title>
	</head>
	<body>
		<h1>Test CMS page coding</h1>
		<script src="http://go.bigpond.com/bphf/res/js/s_code_dev.js" type="text/javascript"></script>
		<script type="text/javascript">
			// Code to go on the BigPond CMS. Users will define the hierarchy variable only.
			// e.g.
			// VBM.hier1 = 'BP|Services|Internet|BPTV|TBox';
			
			try {
				if (typeof VBM === 'undefined') {
					throw ('err');
					}
			}
			catch(err) {
				var VBM = {};
			}

			VBM.hier1 = 'BP|Services|Internet|BPTV|TBox';
			
			if (VBM.hier1) {
				VBM.pageHierarchy = VBM.hier1.split('|');
				var i;
				s.hier1 = '';
				s.pageName = '';
				for (i = 0; i < VBM.pageHierarchy.length; i += 1) {
					switch (i) {
						case 0:
							s.prop1 = VBM.pageHierarchy[i];
							s.eVar1 = VBM.pageHierarchy[i];
							break;
						case 1:
							s.prop2 = VBM.pageHierarchy[i];
							s.eVar2 = VBM.pageHierarchy[i];
							break;
						case 2:
							s.prop3 = VBM.pageHierarchy[i];
							s.eVar3 = VBM.pageHierarchy[i];
							break;
						case 3:
							s.channel = VBM.pageHierarchy[i];
							s.eVar4 = VBM.pageHierarchy[i];
							break;
						case 4:
							s.prop4 = VBM.pageHierarchy[i];
							s.eVar5 = VBM.pageHierarchy[i];
							break;
						case 5:
							s.prop5 = VBM.pageHierarchy[i];
							s.eVar15 = VBM.pageHierarchy[i];
							break;
					}
					
					// Build up the hierarchy delimited by pipes
					if (i !== 0) {
						s.hier1 = s.hier1 + '|';
					}
					s.hier1 = s.hier1 + VBM.pageHierarchy[i];
					
					// s.pageName skips the second level and delimit by colon
					if (i !== 1) {
						if (i !== 0) 
							s.pageName = s.pageName + ':';
						s.pageName = s.pageName + VBM.pageHierarchy[i];
					}
				}
				var s_code=s.t();if(s_code)document.write(s_code);
			}
		</script>
	</body>
</html>
